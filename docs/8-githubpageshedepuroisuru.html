<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://atu4403.github.io/pelican-lessons-log/theme/css/main.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <title>pelican-lessons-log - 8 GitHubPagesへデプロイする</title>
    <link
      href="https://atu4403.github.io/pelican-lessons-log/feeds/all.atom.xml"
      rel="alternate"
      title="pelican-lessons-log Full Atom Feed"
      type="application/atom+xml"
    />
        <link
      href="https://atu4403.github.io/pelican-lessons-log/feeds/lesson.atom.xml"
      rel="alternate"
      title="pelican-lessons-log Categories Atom Feed"
      type="application/atom+xml"
    />
     </head>
  <body>
    <!-- Header -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="https://atu4403.github.io/pelican-lessons-log">
    <i class="bi bi-book" style="color: cornflowerblue"></i> pelican-lessons-log</a
  >
  <button
    class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#navbarNav"
    aria-controls="navbarNav"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
        <li class="nav-item">
        <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/pages/lian-luo-xian.html">連絡先</a>
      </li>
         <li class="nav-item">
        <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/category/diary.html">diary</a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/category/lesson.html">Lesson</a>
      </li>
     </ul>
  </div>
</nav>
    <div class="container-fluid">
      <div class="row">
<nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
  <ul class="navbar-nav">
    <h3>Lesson</h3>
     <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/hazimeni.html"
        >はじめに</a
      >
    </li>
      <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/1-my-first-article.html"
        >1 My First Article</a
      >
    </li>
        <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/2-jing-de-pezitorinku.html"
        >2 静的ページとリンク</a
      >
    </li>
        <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/3-temanoshe-ding.html"
        >3 テーマの設定</a
      >
    </li>
      <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/4-temanozuo-cheng-1.html"
        >4 テーマの作成(1)</a
      >
    </li>
      <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/5-temanozuo-cheng-2.html"
        >5 テーマの作成(2)</a
      >
    </li>
      <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/6-temanozuo-cheng-3.html"
        >6 テーマの作成(3)</a
      >
    </li>
      <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/7-puraguinnozuo-cheng.html"
        >7 プラグインの作成</a
      >
    </li>
      <li class="nav-item">
      <a class="nav-link" href="https://atu4403.github.io/pelican-lessons-log/8-githubpageshedepuroisuru.html"
        >8 GitHubPagesへデプロイする</a
      >
    </li>
   </ul>
</nav>
        <!-- Main Content -->
        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
          >
<section class="body" id="content">
  <header>
    <h2 class="entry-title display-5">
      <a
        href="https://atu4403.github.io/pelican-lessons-log/8-githubpageshedepuroisuru.html"
        rel="bookmark"
        title="Permalink to 8 GitHubPagesへデプロイする"
        >8 GitHubPagesへデプロイする</a
      >
    </h2>
 
  </header>

  <!-- /.post-info -->
  <div class="entry-content"><p>ここではgithub pagesへデプロイする方法を解説します。</p>
<h2>基本的な手順</h2>
<h3>1. <code>publishconf.py</code>のSITEURLを設定</h3>
<p>'publishconf.py'の<code>SITEURL</code>を設定することで、リンクが本番環境用のものになります。</p>
<p>GitHubPagesのURLは<code>https://{アカウント名}.github.io/{リポジトリ名}</code>となります。</p>
<h3>2. <code>make publish</code></h3>
<p><code>make publish</code>コマンドの実行により<code>publishconf.py</code>の設定からビルドが行われます。デフォルトでは一旦<code>output</code>ディレクトリを削除してからビルドするようになっているので、<code>make clean</code>を実行する必要はありません。</p>
<h3>3. git add &amp; commit</h3>
<p>ここまで問題がなければcommitしておきます。</p>
<h3>4. githubリポジトリの作成とpush</h3>
<p>githubにpushします。github側にリポジトリを作っていないのなら、<code>gh repo create</code>が便利です。(ghコマンドは別途インストールが必要です)</p>
<h3>5. <code>make github</code>(<code>ghp-import</code>のインストールが必要)</h3>
<p><code>make github</code>の実行により、面倒な設定を飛ばしてGitHubPagesのデプロイができます。ただし、内部的には<code>ghp-import</code>というコマンドを実行しているので、このインストールが必要になります。</p>
<div class="highlight"><pre><span></span><code>rye<span class="w"> </span>add<span class="w"> </span>ghp-import
rye<span class="w"> </span>sync
make<span class="w"> </span>github
</code></pre></div>

<p><code>https://{アカウント名}.github.io/{リポジトリ名}</code>にアクセスしてサイトが表示されるか確認してください。</p>
<h2>個人的なベストプラクティス</h2>
<p>上記で解説した方法は更新時に若干の手間がかかります。</p>
<ol>
<li><code>make publish</code></li>
<li>git add &amp; commit &amp; push</li>
<li><code>make github</code></li>
</ol>
<p>makeコマンドを2回行うのが冗長に感じます。また、再度ローカルでの確認を行うには<code>make clean</code>と<code>make devserver</code>を実行する必要があり、これも若干面倒です。</p>
<p>GitHubPagesにサイトを構築する具体的な方法は、<code>gh-pages</code>ブランチにコンテンツを配置することです。<br>
しかし<code>main</code>ブランチの<code>docs</code>ディレクトリからコンテンツを読み込む設定もあります。
この設定を行えば、上記3の工程は不要になります。</p>
<h3>設定方法</h3>
<div class="highlight"><pre><span></span><code><span class="c1">#　修正前</span>
publish:
<span class="w">    </span><span class="s2">&quot;</span><span class="k">$(</span>PELICAN<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>INPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>OUTPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>PUBLISHCONF<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">$(</span>PELICANOPTS<span class="k">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">#　修正後</span>
publish:
<span class="w">    </span><span class="s2">&quot;</span><span class="k">$(</span>PELICAN<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>INPUTDIR<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>BASEDIR<span class="k">)</span><span class="s2">/docs&quot;</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>PUBLISHCONF<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">$(</span>PELICANOPTS<span class="k">)</span>
</code></pre></div>

<ol>
<li><code>Makefile</code>を上記のように書き換える</li>
<li><code>.gitignore</code>に<code>output/</code>を追加</li>
<li>GitHubの設定を変更します。<code>settings</code> -&gt; <code>pages</code> -&gt; <code>Build and deployment</code>の<code>Branch</code>を<code>main</code>,<code>/docs</code>に変更してsaveすると完了です。</li>
</ol>
<p>これで<code>make publish</code>すると<code>docs</code>ディレクトリにコンテンツがビルドされます。
そのままcommit &amp; pushするだけで自動的にGitHubPagesも更新されます。</p>
<p><code>make devserver</code>では<code>output</code>ディレクトリにコンテンツがビルドされるので、開発用として使えます。<br>
<code>output</code>ディレクトリをgit管理する必要は無いので外しています。</p>
<p>注意点</p>
<ul>
<li>キャッシュの問題で<code>docs</code>ディレクトリが作成されない時は<code>pelican --ignore-cache</code>として実行すると反映される。</li>
<li><code>make publish</code>したものをpushしてからGitHubPagesに反映されるまで数分かかる。</li>
</ul></div>
  <!-- /.entry-content -->
  <ul>
   </ul>
  <footer class="post-info">
    <time class="published" datetime="2023-09-10T14:00:00+09:00">
      2023-09-10
    </time>
     <address class="vcard author">
      By       <a class="url fn" href="https://atu4403.github.io/pelican-lessons-log/author/atu4403.html">atu4403</a>
    </address>
     <div class="category">
      Category:
      <a href="https://atu4403.github.io/pelican-lessons-log/category/lesson.html"
        >Lesson</a
      >
    </div>
   </footer>
</section>
          </div>
        </main>
      </div>
    </div>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>